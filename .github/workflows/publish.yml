# Publish Hermes Container
# Uses the standardized reusable workflow from logos
# Part of c-daly/logos#431 - Standardize CI/CD across LOGOS repos

name: Publish Hermes Container

on:
  push:
    branches: [main]
    paths:
      - 'src/**'
      - 'Dockerfile'
      - 'pyproject.toml'
      - 'poetry.lock'
  release:
    types: [published]
  workflow_dispatch:

permissions:
  contents: read
  packages: write

jobs:
  free-disk-space:
    runs-on: ubuntu-latest
    steps:
      - name: Free up disk space
        run: |
          sudo rm -rf /usr/local/lib/android
          sudo docker system prune -af
          sudo rm -rf /opt/hostedtoolcache/*
          sudo apt-get clean
          df -h
  publish:
    uses: c-daly/logos/.github/workflows/reusable-publish.yml@main
    with:
      image_name: hermes
    secrets: inherit
