# Publish Hermes Container
# Uses the standardized reusable workflow from logos

name: Publish Hermes Container

on:
  push:
    branches: [main]
    paths:
      - 'src/**'
      - 'Dockerfile'
      - 'pyproject.toml'
      - 'poetry.lock'
  release:
    types:  [published]
  workflow_dispatch:

permissions:
  contents:  read
  packages: write

jobs:
  publish:
    uses: c-daly/logos/.github/workflows/reusable-publish.yml@ci/v1
    with:
      image_name: hermes
      tag_override: latest
    secrets: inherit

  publish-ml:
    uses: c-daly/logos/.github/workflows/reusable-publish.yml@ci/v1
    with:
      image_name: hermes
      tag_override: ml-latest
      build_args: |
        HERMES_INSTALL_ML=1
    secrets: inherit
